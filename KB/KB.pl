:- discontiguous cp/1.age(63.0).
cp(3.0).
age(37.0).
cp(2.0).
age(41.0).
cp(1.0).
age(56.0).
cp(1.0).
age(57.0).
cp(0.0).
age(57.0).
cp(0.0).
age(56.0).
cp(1.0).
age(44.0).
cp(1.0).
age(52.0).
cp(2.0).
age(57.0).
cp(2.0).
age(54.0).
cp(0.0).
age(48.0).
cp(2.0).
age(49.0).
cp(1.0).
age(64.0).
cp(3.0).
age(58.0).
cp(3.0).
age(50.0).
cp(2.0).
age(58.0).
cp(2.0).
age(66.0).
cp(3.0).
age(43.0).
cp(0.0).
age(69.0).
cp(3.0).
age(59.0).
cp(0.0).
age(44.0).
cp(2.0).
age(42.0).
cp(0.0).
age(61.0).
cp(2.0).
age(40.0).
cp(3.0).
age(71.0).
cp(1.0).
age(59.0).
cp(2.0).
age(51.0).
cp(2.0).
age(65.0).
cp(2.0).
age(53.0).
cp(2.0).
age(41.0).
cp(1.0).
age(65.0).
cp(0.0).
age(44.0).
cp(1.0).
age(54.0).
cp(2.0).
age(51.0).
cp(3.0).
age(46.0).
cp(2.0).
age(54.0).
cp(2.0).
age(54.0).
cp(2.0).
age(65.0).
cp(2.0).
age(65.0).
cp(2.0).
age(51.0).
cp(2.0).
age(48.0).
cp(1.0).
age(45.0).
cp(0.0).
age(53.0).
cp(0.0).
age(39.0).
cp(2.0).
age(52.0).
cp(1.0).
age(44.0).
cp(2.0).
age(47.0).
cp(2.0).
age(53.0).
cp(2.0).
age(53.0).
cp(0.0).
age(51.0).
cp(2.0).
age(66.0).
cp(0.0).
age(62.0).
cp(2.0).
age(44.0).
cp(2.0).
age(63.0).
cp(2.0).
age(52.0).
cp(1.0).
age(48.0).
cp(0.0).
age(45.0).
cp(0.0).
age(34.0).
cp(3.0).
age(57.0).
cp(0.0).
age(71.0).
cp(2.0).
age(54.0).
cp(1.0).
age(52.0).
cp(3.0).
age(41.0).
cp(1.0).
age(58.0).
cp(2.0).
age(35.0).
cp(0.0).
age(51.0).
cp(2.0).
age(45.0).
cp(1.0).
age(44.0).
cp(1.0).
age(62.0).
cp(0.0).
age(54.0).
cp(2.0).
age(51.0).
cp(2.0).
age(29.0).
cp(1.0).
age(51.0).
cp(0.0).
age(43.0).
cp(2.0).
age(55.0).
cp(1.0).
age(51.0).
cp(2.0).
age(59.0).
cp(1.0).
age(52.0).
cp(1.0).
age(58.0).
cp(2.0).
age(41.0).
cp(2.0).
age(45.0).
cp(1.0).
age(60.0).
cp(2.0).
age(52.0).
cp(3.0).
age(42.0).
cp(0.0).
age(67.0).
cp(2.0).
age(68.0).
cp(2.0).
age(46.0).
cp(1.0).
age(54.0).
cp(2.0).
age(58.0).
cp(0.0).
age(48.0).
cp(2.0).
age(57.0).
cp(0.0).
age(52.0).
cp(2.0).
age(54.0).
cp(1.0).
age(45.0).
cp(1.0).
age(53.0).
cp(0.0).
age(62.0).
cp(0.0).
age(52.0).
cp(0.0).
age(43.0).
cp(2.0).
age(53.0).
cp(2.0).
age(42.0).
cp(3.0).
age(59.0).
cp(3.0).
age(63.0).
cp(1.0).
age(42.0).
cp(2.0).
age(50.0).
cp(2.0).
age(68.0).
cp(2.0).
age(69.0).
cp(3.0).
age(45.0).
cp(0.0).
age(50.0).
cp(1.0).
age(50.0).
cp(0.0).
age(64.0).
cp(0.0).
age(57.0).
cp(2.0).
age(64.0).
cp(2.0).
age(43.0).
cp(0.0).
age(55.0).
cp(1.0).
age(37.0).
cp(2.0).
age(41.0).
cp(2.0).
age(56.0).
cp(3.0).
age(46.0).
cp(1.0).
age(46.0).
cp(0.0).
age(64.0).
cp(0.0).
age(59.0).
cp(0.0).
age(41.0).
cp(2.0).
age(54.0).
cp(2.0).
age(39.0).
cp(2.0).
age(34.0).
cp(1.0).
age(47.0).
cp(0.0).
age(67.0).
cp(2.0).
age(52.0).
cp(2.0).
age(74.0).
cp(1.0).
age(54.0).
cp(2.0).
age(49.0).
cp(1.0).
age(42.0).
cp(1.0).
age(41.0).
cp(1.0).
age(41.0).
cp(1.0).
age(49.0).
cp(0.0).
age(60.0).
cp(2.0).
age(62.0).
cp(1.0).
age(57.0).
cp(0.0).
age(64.0).
cp(0.0).
age(51.0).
cp(2.0).
age(43.0).
cp(0.0).
age(42.0).
cp(2.0).
age(67.0).
cp(0.0).
age(76.0).
cp(2.0).
age(70.0).
cp(1.0).
age(44.0).
cp(2.0).
age(60.0).
cp(3.0).
age(44.0).
cp(2.0).
age(42.0).
cp(2.0).
age(66.0).
cp(0.0).
age(71.0).
cp(0.0).
age(64.0).
cp(3.0).
age(66.0).
cp(2.0).
age(39.0).
cp(2.0).
age(58.0).
cp(0.0).
age(47.0).
cp(2.0).
age(35.0).
cp(1.0).
age(58.0).
cp(1.0).
age(56.0).
cp(1.0).
age(56.0).
cp(1.0).
age(55.0).
cp(1.0).
age(41.0).
cp(1.0).
age(38.0).
cp(2.0).
age(38.0).
cp(2.0).
age(67.0).
cp(0.0).
age(67.0).
cp(0.0).
age(62.0).
cp(0.0).
age(63.0).
cp(0.0).
age(53.0).
cp(0.0).
age(56.0).
cp(2.0).
age(48.0).
cp(1.0).
age(58.0).
cp(1.0).
age(58.0).
cp(2.0).
age(60.0).
cp(0.0).
age(40.0).
cp(0.0).
age(60.0).
cp(0.0).
age(64.0).
cp(2.0).
age(43.0).
cp(0.0).
age(57.0).
cp(0.0).
age(55.0).
cp(0.0).
age(65.0).
cp(0.0).
age(61.0).
cp(0.0).
age(58.0).
cp(2.0).
age(50.0).
cp(0.0).
age(44.0).
cp(0.0).
age(60.0).
cp(0.0).
age(54.0).
cp(0.0).
age(50.0).
cp(2.0).
age(41.0).
cp(0.0).
age(51.0).
cp(0.0).
age(58.0).
cp(0.0).
age(54.0).
cp(0.0).
age(60.0).
cp(0.0).
age(60.0).
cp(2.0).
age(59.0).
cp(0.0).
age(46.0).
cp(2.0).
age(67.0).
cp(0.0).
age(62.0).
cp(0.0).
age(65.0).
cp(0.0).
age(44.0).
cp(0.0).
age(60.0).
cp(0.0).
age(58.0).
cp(0.0).
age(68.0).
cp(2.0).
age(62.0).
cp(0.0).
age(52.0).
cp(0.0).
age(59.0).
cp(0.0).
age(60.0).
cp(0.0).
age(49.0).
cp(2.0).
age(59.0).
cp(0.0).
age(57.0).
cp(2.0).
age(61.0).
cp(0.0).
age(39.0).
cp(0.0).
age(61.0).
cp(0.0).
age(56.0).
cp(0.0).
age(43.0).
cp(0.0).
age(62.0).
cp(2.0).
age(63.0).
cp(0.0).
age(65.0).
cp(0.0).
age(48.0).
cp(0.0).
age(63.0).
cp(0.0).
age(55.0).
cp(0.0).
age(65.0).
cp(3.0).
age(56.0).
cp(0.0).
age(54.0).
cp(0.0).
age(70.0).
cp(0.0).
age(62.0).
cp(1.0).
age(35.0).
cp(0.0).
age(59.0).
cp(3.0).
age(64.0).
cp(2.0).
age(47.0).
cp(2.0).
age(57.0).
cp(0.0).
age(55.0).
cp(0.0).
age(64.0).
cp(0.0).
age(70.0).
cp(0.0).
age(51.0).
cp(0.0).
age(58.0).
cp(0.0).
age(60.0).
cp(0.0).
age(77.0).
cp(0.0).
age(35.0).
cp(0.0).
age(70.0).
cp(2.0).
age(59.0).
cp(0.0).
age(64.0).
cp(0.0).
age(57.0).
cp(0.0).
age(56.0).
cp(0.0).
age(48.0).
cp(0.0).
age(56.0).
cp(0.0).
age(66.0).
cp(1.0).
age(54.0).
cp(1.0).
age(69.0).
cp(2.0).
age(51.0).
cp(0.0).
age(43.0).
cp(0.0).
age(62.0).
cp(0.0).
age(67.0).
cp(0.0).
age(59.0).
cp(3.0).
age(45.0).
cp(0.0).
age(58.0).
cp(0.0).
age(50.0).
cp(0.0).
age(62.0).
cp(0.0).
age(38.0).
cp(3.0).
age(66.0).
cp(0.0).
age(52.0).
cp(0.0).
age(53.0).
cp(0.0).
age(63.0).
cp(0.0).
age(54.0).
cp(0.0).
age(66.0).
cp(0.0).
age(55.0).
cp(0.0).
age(49.0).
cp(2.0).
age(54.0).
cp(0.0).
age(56.0).
cp(0.0).
age(46.0).
cp(0.0).
age(61.0).
cp(3.0).
age(67.0).
cp(0.0).
age(58.0).
cp(0.0).
age(47.0).
cp(0.0).
age(52.0).
cp(0.0).
age(58.0).
cp(0.0).
age(57.0).
cp(1.0).
age(58.0).
cp(1.0).
age(61.0).
cp(0.0).
age(42.0).
cp(0.0).
age(52.0).
cp(0.0).
age(59.0).
cp(2.0).
age(40.0).
cp(0.0).
age(61.0).
cp(0.0).
age(46.0).
cp(0.0).
age(59.0).
cp(3.0).
age(57.0).
cp(1.0).
age(57.0).
cp(0.0).
age(55.0).
cp(0.0).
age(61.0).
cp(0.0).
age(58.0).
cp(0.0).
age(58.0).
cp(0.0).
age(67.0).
cp(2.0).
age(44.0).
cp(0.0).
age(63.0).
cp(0.0).
age(63.0).
cp(0.0).
age(59.0).
cp(0.0).
age(57.0).
cp(0.0).
age(45.0).
cp(3.0).
age(68.0).
cp(0.0).
age(57.0).
cp(0.0).
age(57.0).
cp(1.0).

% Regola 1: per determinare se una persona può avere un attacco cardiaco.
puo_avere_attacco_cardiaco(Eta, TipoDolore, AnginaEsercizio, Pendenza, NumeroVasi, RisultatoThallium, FrequenzaCardiaca, PiccoPrecedente, PuoAvereAttacco) :-
    % Condizioni per non avere un attacco cardiaco
    not((
        TipoDolore == 0, % Angina tipica
        AnginaEsercizio == 1, % Angina pectoris causata dall'esercizio
        (Pendenza == 0; Pendenza == 1), % Pendenza pari a 0 o 1
        NumeroVasi =< 3, % Numero di grandi vasi minore o uguale a 3
        RisultatoThallium == 3, % Risultato del test al thallium uguale a 3
        (Eta > 50; Eta < 30), % Età maggiore di 50 o minore di 30
        FrequenzaCardiaca < 130, % Frequenza cardiaca massima minore di 130
        PiccoPrecedente > 2.0 % Picco precedente alto
    )),
    % Se non soddisfa le condizioni, allora può avere un attacco cardiaco
    PuoAvereAttacco = no.

% Regola 2: per determinare se una persona può avere un attacco
% cardiaco, usando una somma di valori.
puo_avere_attacco_cardiaco_prob(Eta, TipoDolore, AnginaEsercizio, Pendenza, NumeroVasi, RisultatoThallium, FrequenzaCardiaca, PiccoPrecedente, PuoAvereAttacco) :-
    % Condizioni per non avere un attacco cardiaco
    (
        (TipoDolore == 0 -> ValoreCondizione1 = 0; ValoreCondizione1 = 1), % Angina tipica
        (AnginaEsercizio == 1 -> ValoreCondizione2 = 0; ValoreCondizione2 = 1), % Angina pectoris causata dall'esercizio
        ((Pendenza == 0; Pendenza == 1) -> ValoreCondizione3 = 0; ValoreCondizione3 = 1), % Pendenza pari a 0 o 1
        (NumeroVasi =< 3 -> ValoreCondizione4 = 0; ValoreCondizione4 = 1), % Numero di grandi vasi minore o uguale a 3
        (RisultatoThallium == 3 -> ValoreCondizione5 = 0; ValoreCondizione5 = 1), % Risultato del test al thallium uguale a 3
        ((Eta > 50; Eta < 30) -> ValoreCondizione6 = 0; ValoreCondizione6 = 1), % Età maggiore di 50 o minore di 30
        (FrequenzaCardiaca < 130 -> ValoreCondizione7 = 0; ValoreCondizione7 = 1), % Frequenza cardiaca massima minore di 130
        (PiccoPrecedente > 2.0 -> ValoreCondizione8 = 0; ValoreCondizione8 = 1) % Picco precedente alto
    ),
    % Somma dei valori delle condizioni
    SommaCondizioni is ValoreCondizione1 + ValoreCondizione2 + ValoreCondizione3 + ValoreCondizione4 + ValoreCondizione5 + ValoreCondizione6 + ValoreCondizione7 + ValoreCondizione8,
    % Se la somma è maggiore di 4, allora può avere un attacco cardiaco
    (SommaCondizioni > 4 -> PuoAvereAttacco = si; PuoAvereAttacco = no).



% Regola 3: per calcolare l'età media delle persone con attacco cardiaco
eta_media_persone_attacco_cardiaco(MediaEtà) :-
    findall(Age, (age(Age), Age > 0), ListeEtà), % Estrai le età delle persone con attacco cardiaco
    length(ListeEtà, NumeroPersone), % Conta il numero di persone con attacco cardiaco
    sum_list(ListeEtà, SommaEtà), % Somma le età
    MediaEtà is SommaEtà / NumeroPersone. % Calcola l'età media


% Regola 4: per determinare il tipo di dolore toracico più comune
tipo_dolore_piu_comune(TipoDolorePiuComune) :-
    findall(Tipo, (cp(Tipo), Tipo >= 0, Tipo =< 3), TipiDolore), % Estrai i tipi di dolore toracico
    list_to_set(TipiDolore, TipiUnici), % Rimuovi duplicati
    conta_tipi_dolore(TipiUnici, TipiDolore, TipoDoloreConteggi), % Conta quanti individui hanno ciascun tipo di dolore
    trova_tipo_piu_comune(TipoDoloreConteggi, TipoDolorePiuComune). % Trova il tipo di dolore più comune

% Regola 5: per contare quanti individui hanno ciascun tipo di dolore toracico
conta_tipi_dolore([], _, []).
conta_tipi_dolore([Tipo|Resto], TipiDolore, [(Tipo, Conteggio)|RestoConteggi]) :-
    conta_occorrenze_tipo(Tipo, TipiDolore, Conteggio),
    conta_tipi_dolore(Resto, TipiDolore, RestoConteggi).

% Regola 6: per contare quante volte un tipo di dolore appare nella lista
conta_occorrenze_tipo(_, [], 0).
conta_occorrenze_tipo(Tipo, [Tipo|Resto], Conteggio) :-
    conta_occorrenze_tipo(Tipo, Resto, ConteggioResto),
    Conteggio is ConteggioResto + 1.
conta_occorrenze_tipo(Tipo, [_|Resto], Conteggio) :-
    conta_occorrenze_tipo(Tipo, Resto, Conteggio).

% Regola 7: per trovare il tipo di dolore più comune
trova_tipo_piu_comune([(Tipo, Conteggio)], Tipo).
trova_tipo_piu_comune([(Tipo1, Conteggio1), (Tipo2, Conteggio2)|Resto], TipoPiuComune) :-
    (Conteggio1 >= Conteggio2 -> trova_tipo_piu_comune([(Tipo1, Conteggio1)|Resto], TipoPiuComune)
    ; trova_tipo_piu_comune([(Tipo2, Conteggio2)|Resto], TipoPiuComune)).



